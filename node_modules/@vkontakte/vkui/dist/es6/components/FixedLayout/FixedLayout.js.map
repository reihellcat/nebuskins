{"version":3,"sources":["../../../../src/components/FixedLayout/FixedLayout.tsx"],"names":["React","getClassName","PropTypes","classNames","transitionEndEventName","transitionStartEventName","tabbarHeight","withInsets","isNumeric","withPlatform","FixedLayout","position","top","e","panelScroll","detail","scrolls","context","panel","setState","el","offsetTop","element","getRootRef","props","current","document","addEventListener","onViewTransitionStart","onViewTransitionEnd","removeEventListener","className","children","style","vertical","insets","platform","filled","restProps","tabbarPadding","hasTabbar","paddingBottom","bottom","getRef","state","Component","string","any","bool"],"mappings":"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","sourcesContent":["import React, { HTMLAttributes } from 'react';\nimport getClassName from '../../helpers/getClassName';\nimport PropTypes, { Requireable } from 'prop-types';\nimport classNames from '../../lib/classNames';\nimport { transitionEndEventName, TransitionStartEventDetail, transitionStartEventName } from '../View/View';\nimport { tabbarHeight } from '../../appearance/constants';\nimport withInsets from '../../hoc/withInsets';\nimport { isNumeric } from '../../lib/utils';\nimport { HasInsets, HasPlatform, HasRootRef, OldRef } from '../../types';\nimport withPlatform from '../../hoc/withPlatform';\n\nexport interface FixedLayoutProps extends\n  HTMLAttributes<HTMLDivElement>,\n  HasRootRef<HTMLDivElement>,\n  HasInsets,\n  HasPlatform {\n  vertical?: 'top' | 'bottom';\n  /**\n   * Это свойство определяет, будет ли фон компонента окрашен в цвет фона контента.\n   * Это часто необходимо для фиксированных кнопок в нижней части экрана.\n   */\n  filled?: boolean;\n}\n\nexport interface FixedLayoutState {\n  position: 'absolute' | null;\n  top: number;\n}\n\nexport interface FixedLayoutContext {\n  panel: Requireable<string>;\n  document: Requireable<{}>;\n  hasTabbar: Requireable<boolean>;\n}\n\nclass FixedLayout extends React.Component<FixedLayoutProps, FixedLayoutState> {\n  state: FixedLayoutState = {\n    position: null,\n    top: null,\n  };\n\n  el: HTMLDivElement;\n\n  static contextTypes: FixedLayoutContext = {\n    panel: PropTypes.string,\n    document: PropTypes.any,\n    hasTabbar: PropTypes.bool,\n  };\n\n  get document() {\n    return this.context.document || document;\n  }\n\n  componentDidMount() {\n    this.document.addEventListener(transitionStartEventName, this.onViewTransitionStart);\n    this.document.addEventListener(transitionEndEventName, this.onViewTransitionEnd);\n  }\n\n  componentWillUnmount() {\n    this.document.removeEventListener(transitionStartEventName, this.onViewTransitionStart);\n    this.document.removeEventListener(transitionEndEventName, this.onViewTransitionEnd);\n  }\n\n  onViewTransitionStart: EventListener = (e: CustomEvent<TransitionStartEventDetail>) => {\n    let panelScroll = e.detail.scrolls[this.context.panel] || 0;\n    this.setState({\n      position: 'absolute',\n      top: this.el.offsetTop + panelScroll,\n    });\n  };\n\n  onViewTransitionEnd: VoidFunction = () => {\n    this.setState({\n      position: null,\n      top: null,\n    });\n  };\n\n  getRef: OldRef<HTMLDivElement> = (element: HTMLDivElement) => {\n    this.el = element;\n\n    const getRootRef = this.props.getRootRef;\n    if (getRootRef) {\n      if (typeof getRootRef === 'function') {\n        getRootRef(element);\n      } else {\n        getRootRef.current = element;\n      }\n    }\n  };\n\n  render() {\n    const { className, children, style, vertical, getRootRef, insets, platform, filled, ...restProps } = this.props;\n    const tabbarPadding = this.context.hasTabbar ? tabbarHeight : 0;\n    const paddingBottom = vertical === 'bottom' && isNumeric(insets.bottom) ? insets.bottom + tabbarPadding : null;\n\n    return (\n      <div\n        {...restProps}\n        ref={this.getRef}\n        className={classNames(getClassName('FixedLayout', platform), {\n          'FixedLayout--filled': filled,\n        }, `FixedLayout--${vertical}`, className)}\n        style={{ ...style, ...this.state, paddingBottom }}\n      >\n        <div className=\"FixedLayout__in\">{children}</div>\n      </div>\n    );\n  }\n}\n\nexport default withPlatform(withInsets(FixedLayout));\n"],"file":"FixedLayout.js"}