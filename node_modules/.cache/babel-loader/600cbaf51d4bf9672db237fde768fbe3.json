{"ast":null,"code":"import _objectSpread from \"C:\\\\Users\\\\\\u041F\\u0430\\u0432\\u0435\\u043B\\\\Desktop\\\\vkapp\\\\nebuskins\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport _toConsumableArray from \"C:\\\\Users\\\\\\u041F\\u0430\\u0432\\u0435\\u043B\\\\Desktop\\\\vkapp\\\\nebuskins\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"C:\\\\Users\\\\\\u041F\\u0430\\u0432\\u0435\\u043B\\\\Desktop\\\\vkapp\\\\nebuskins\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\\\u041F\\u0430\\u0432\\u0435\\u043B\\\\Desktop\\\\vkapp\\\\nebuskins\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\\\u041F\\u0430\\u0432\\u0435\\u043B\\\\Desktop\\\\vkapp\\\\nebuskins\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\\\u041F\\u0430\\u0432\\u0435\\u043B\\\\Desktop\\\\vkapp\\\\nebuskins\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\\\u041F\\u0430\\u0432\\u0435\\u043B\\\\Desktop\\\\vkapp\\\\nebuskins\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\\\u041F\\u0430\\u0432\\u0435\\u043B\\\\Desktop\\\\vkapp\\\\nebuskins\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"C:\\\\Users\\\\\\u041F\\u0430\\u0432\\u0435\\u043B\\\\Desktop\\\\vkapp\\\\nebuskins\\\\src\\\\Page.js\";\nimport React from \"react\";\nimport PropTypes from \"prop-types\";\nimport vkConnect from \"@vkontakte/vk-connect\";\nimport View from \"@vkontakte/vkui/dist/components/View/View\";\nimport ScreenSpinner from \"@vkontakte/vkui/dist/components/ScreenSpinner/ScreenSpinner\";\nimport Alert from \"@vkontakte/vkui/dist/components/Alert/Alert\";\n\nvar Page = /*#__PURE__*/function (_React$Component) {\n  _inherits(Page, _React$Component);\n\n  function Page(props) {\n    var _this;\n\n    _classCallCheck(this, Page);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Page).call(this, props));\n    _this.state = {\n      activePanel: props.activePanel,\n      homePanel: props.activePanel,\n      history: [props.activePanel],\n      popout: null,\n      params: {},\n      header: props.header\n    };\n    _this.go = _this.go.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.goPage = _this.props.goPage;\n    _this.popBack = _this.popBack.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.showModal = _this.showModal.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.hideModal = _this.hideModal.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.showPopout = _this.showPopout.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.showLoader = _this.showLoader.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.hideLoader = _this.hideLoader.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.showDialog = _this.showDialog.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.showAlert = _this.showAlert.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.headerVisible = _this.headerVisible.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.navigatorObject = {\n      go: _this.go,\n      goPage: _this.goPage,\n      goBack: window.history.back.bind(window.history),\n      showModal: _this.showModal,\n      hideModal: function hideModal() {\n        return window.history.back;\n      },\n      showPopout: _this.showPopout,\n      showLoader: _this.showLoader,\n      hideLoader: _this.hideLoader,\n      showDialog: _this.showDialog,\n      showAlert: _this.showAlert,\n      headerVisible: _this.headerVisible\n    };\n    return _this;\n  }\n  /*\r\n  \tФункция перехода на следующую панель\r\n  \tparams:\r\n  \t\t@newPanel - id новой панели\r\n  \t\t@params - параметры, которые передаются в новую панель\r\n  \t\t\t\t  в качестве prop-параметра `params`\r\n   */\n\n\n  _createClass(Page, [{\n    key: \"go\",\n    value: function go(newPanel) {\n      var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var _this$state = this.state,\n          activePanel = _this$state.activePanel,\n          homePanel = _this$state.homePanel,\n          history = _this$state.history;\n\n      if (activePanel === homePanel) {\n        vkConnect.send(\"VKWebAppEnableSwipeBack\", {});\n      }\n\n      window.history.pushState({\n        panel: newPanel,\n        modal: null\n      }, newPanel);\n      this.setState({\n        activePanel: newPanel,\n        history: [].concat(_toConsumableArray(history), [newPanel]),\n        popout: null,\n        params: params\n      });\n    }\n    /*\r\n    \tФункция возврата на предыдущую панель\r\n     */\n\n  }, {\n    key: \"popBack\",\n    value: function popBack() {\n      var _this$state2 = this.state,\n          history = _this$state2.history,\n          popout = _this$state2.popout,\n          homePanel = _this$state2.homePanel;\n      var isModalOpen = this.props.isModalOpen;\n      var hideModal = this.hideModal;\n\n      if (popout !== null) {\n        this.setState({\n          popout: null\n        });\n        return;\n      }\n\n      if (isModalOpen) {\n        hideModal();\n        return;\n      }\n\n      if (history.length === 1) return null;\n      var newPanel = history[history.length - 2];\n\n      if (newPanel === homePanel) {\n        vkConnect.send(\"VKWebAppDisableSwipeBack\", {});\n      }\n\n      this.setState({\n        activePanel: newPanel,\n        history: history.slice(0, history.length - 1),\n        popout: null,\n        activeModal: null,\n        modalHistory: [],\n        modalParams: {}\n      });\n    }\n    /*\r\n    \tФункция установки popout\r\n    \tparams:\r\n    \t\t@obj - объект popout\r\n     */\n\n  }, {\n    key: \"showPopout\",\n    value: function showPopout(obj) {\n      this.setState({\n        popout: obj\n      });\n    }\n    /*\r\n    \tЗаготовки popout'ов\r\n     */\n\n  }, {\n    key: \"showLoader\",\n    value: function showLoader() {\n      this.showPopout( /*#__PURE__*/React.createElement(ScreenSpinner, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 19\n        }\n      }));\n    }\n  }, {\n    key: \"hideLoader\",\n    value: function hideLoader() {\n      this.showPopout(null);\n    }\n  }, {\n    key: \"showDialog\",\n    value: function showDialog(_ref) {\n      var _this2 = this;\n\n      var title = _ref.title,\n          description = _ref.description,\n          buttonText = _ref.buttonText,\n          action = _ref.action;\n      this.showPopout( /*#__PURE__*/React.createElement(Alert, {\n        actionsLayout: \"vertical\",\n        actions: [{\n          title: buttonText || \"Удалить\",\n          action: action,\n          style: \"destructive\"\n        }, {\n          title: \"Отмена\",\n          autoclose: true,\n          style: \"cancel\"\n        }],\n        onClose: function onClose() {\n          return _this2.showPopout(null);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 4\n        }\n      }, /*#__PURE__*/React.createElement(\"h2\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 5\n        }\n      }, title), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 5\n        }\n      }, description)));\n    }\n  }, {\n    key: \"showAlert\",\n    value: function showAlert(_ref2) {\n      var _this3 = this;\n\n      var title = _ref2.title,\n          description = _ref2.description;\n      this.showPopout( /*#__PURE__*/React.createElement(Alert, {\n        actions: [{\n          title: 'Закрыть',\n          autoclose: true,\n          style: 'cancel'\n        }],\n        onClose: function onClose() {\n          return _this3.showPopout(null);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 4\n        }\n      }, /*#__PURE__*/React.createElement(\"h2\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 5\n        }\n      }, title), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 5\n        }\n      }, description)));\n    }\n    /*\r\n    \tФункция, которая показывает модальное окно\r\n    \tparams:\r\n    \t\t@newModal - название нового модального окна\r\n     */\n\n  }, {\n    key: \"showModal\",\n    value: function showModal(newModal) {\n      var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var showModal = this.props.showModal;\n      var activePanel = this.state.activePanel;\n      vkConnect.send(\"VKWebAppDisableSwipeBack\", {});\n      window.history.pushState({\n        panel: activePanel,\n        modal: newModal\n      }, activePanel);\n      showModal(newModal, params);\n    }\n    /*\r\n    \tФункция, которая скрывает все модальные окна\r\n     */\n\n  }, {\n    key: \"hideModal\",\n    value: function hideModal() {\n      var hideModal = this.props.hideModal;\n      var _this$state3 = this.state,\n          activePanel = _this$state3.activePanel,\n          homePanel = _this$state3.homePanel;\n\n      if (activePanel !== homePanel) {\n        vkConnect.send(\"VKWebAppEnableSwipeBack\", {});\n      }\n\n      hideModal();\n    }\n  }, {\n    key: \"headerVisible\",\n    value: function headerVisible(newValue) {\n      this.setState({\n        header: newValue\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var homePanel = this.state.homePanel;\n      vkConnect.send(\"VKWebAppDisableSwipeBack\", {});\n      window.addEventListener(\"popstate\", this.popBack);\n      window.history.replaceState({\n        panel: homePanel\n      }, homePanel);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var history = this.state.history;\n      window.removeEventListener(\"popstate\", this.popBack);\n\n      for (var i = 0; i < history.length - 1; i++) {\n        window.history.back();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          id = _this$props.id,\n          children = _this$props.children,\n          pageParams = _this$props.pageParams;\n      var _this$state4 = this.state,\n          activePanel = _this$state4.activePanel,\n          history = _this$state4.history,\n          popout = _this$state4.popout,\n          params = _this$state4.params,\n          header = _this$state4.header;\n      var navigatorObject = this.navigatorObject;\n      return /*#__PURE__*/React.createElement(View, {\n        id: id,\n        activePanel: activePanel,\n        history: history,\n        popout: popout,\n        header: header,\n        onSwipeBack: window.history.back.bind(window.history),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 4\n        }\n      }, React.Children.map(children, function (Child) {\n        return React.cloneElement(Child, {\n          id: Child.props.id,\n          navigator: _objectSpread({}, navigatorObject, {\n            params: Child.props.id === activePanel ? _objectSpread({}, params, {\n              pageParams: pageParams\n            }) : {}\n          })\n        });\n      }));\n    }\n  }]);\n\n  return Page;\n}(React.Component);\n\nPage.propTypes = {\n  id: PropTypes.string.isRequired,\n  activePanel: PropTypes.string.isRequired,\n  children: PropTypes.any,\n  header: PropTypes.bool\n};\nPropTypes.defaultProps = {\n  children: []\n};\nexport default Page;","map":{"version":3,"sources":["C:/Users/Павел/Desktop/vkapp/nebuskins/src/Page.js"],"names":["React","PropTypes","vkConnect","View","ScreenSpinner","Alert","Page","props","state","activePanel","homePanel","history","popout","params","header","go","bind","goPage","popBack","showModal","hideModal","showPopout","showLoader","hideLoader","showDialog","showAlert","headerVisible","navigatorObject","goBack","window","back","newPanel","send","pushState","panel","modal","setState","isModalOpen","length","slice","activeModal","modalHistory","modalParams","obj","title","description","buttonText","action","style","autoclose","newModal","newValue","addEventListener","replaceState","removeEventListener","i","id","children","pageParams","Children","map","Child","cloneElement","navigator","Component","propTypes","string","isRequired","any","bool","defaultProps"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport vkConnect from \"@vkontakte/vk-connect\";\r\n\r\nimport View from \"@vkontakte/vkui/dist/components/View/View\";\r\nimport ScreenSpinner from \"@vkontakte/vkui/dist/components/ScreenSpinner/ScreenSpinner\";\r\nimport Alert from \"@vkontakte/vkui/dist/components/Alert/Alert\";\r\n\r\nclass Page extends React.Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\tactivePanel: props.activePanel,\r\n\t\t\thomePanel: props.activePanel,\r\n\t\t\thistory: [ props.activePanel ],\r\n\t\t\tpopout: null,\r\n\t\t\tparams: {},\r\n\t\t\theader: props.header\r\n\t\t};\r\n\r\n\r\n\t\tthis.go = this.go.bind(this);\r\n\t\tthis.goPage = this.props.goPage;\r\n\t\tthis.popBack = this.popBack.bind(this);\r\n\t\tthis.showModal = this.showModal.bind(this);\r\n\t\tthis.hideModal = this.hideModal.bind(this);\r\n\t\tthis.showPopout = this.showPopout.bind(this);\r\n\t\tthis.showLoader = this.showLoader.bind(this);\r\n\t\tthis.hideLoader = this.hideLoader.bind(this);\r\n\t\tthis.showDialog = this.showDialog.bind(this);\r\n\t\tthis.showAlert = this.showAlert.bind(this);\r\n\t\tthis.headerVisible = this.headerVisible.bind(this);\r\n\r\n\t\tthis.navigatorObject = {\r\n\t\t\tgo: this.go,\r\n\t\t\tgoPage: this.goPage,\r\n\t\t\tgoBack: window.history.back.bind(window.history),\r\n\t\t\tshowModal: this.showModal,\r\n\t\t\thideModal: () => window.history.back,\r\n\t\t\tshowPopout: this.showPopout,\r\n\t\t\tshowLoader: this.showLoader,\r\n\t\t\thideLoader: this.hideLoader,\r\n\t\t\tshowDialog: this.showDialog,\r\n\t\t\tshowAlert: this.showAlert,\r\n\t\t\theaderVisible: this.headerVisible\r\n\t\t};\r\n\t}\r\n\r\n\t/*\r\n\t\tФункция перехода на следующую панель\r\n\t\tparams:\r\n\t\t\t@newPanel - id новой панели\r\n\t\t\t@params - параметры, которые передаются в новую панель\r\n\t\t\t\t\t  в качестве prop-параметра `params`\r\n\t */\r\n\tgo(newPanel, params={}) {\r\n\t\tconst { activePanel, homePanel, history } = this.state;\r\n\r\n\t\tif (activePanel === homePanel) {\r\n\t\t\tvkConnect.send(\"VKWebAppEnableSwipeBack\", {});\r\n\t\t}\r\n\r\n\t\twindow.history.pushState({ panel: newPanel, modal: null }, newPanel);\r\n\t\tthis.setState({\r\n\t\t\tactivePanel: newPanel,\r\n\t\t\thistory: [ ...history, newPanel ],\r\n\t\t\tpopout: null,\r\n\t\t\tparams\r\n\t\t});\r\n\t}\r\n\r\n\t/*\r\n\t\tФункция возврата на предыдущую панель\r\n\t */\r\n\tpopBack() {\r\n\t\tconst { history, popout, homePanel } = this.state;\r\n\t\tconst { isModalOpen } = this.props;\r\n\t\tconst { hideModal } = this;\r\n\r\n\t\tif (popout !== null) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tpopout: null\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (isModalOpen) {\r\n\t\t\thideModal();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (history.length === 1) return null;\r\n\r\n\t\tconst newPanel = history[history.length - 2];\r\n\t\tif (newPanel === homePanel) {\r\n\t\t\tvkConnect.send(\"VKWebAppDisableSwipeBack\", {});\r\n\t\t}\r\n\r\n\t\tthis.setState({\r\n\t\t\tactivePanel: newPanel,\r\n\t\t\thistory: history.slice(0, history.length - 1),\r\n\t\t\tpopout: null,\r\n\t\t\tactiveModal: null,\r\n\t\t\tmodalHistory: [],\r\n\t\t\tmodalParams: {},\r\n\t\t});\r\n\t}\r\n\r\n\t/*\r\n\t\tФункция установки popout\r\n\t\tparams:\r\n\t\t\t@obj - объект popout\r\n\t */\r\n\tshowPopout(obj) {\r\n\t\tthis.setState({ popout: obj });\r\n\t}\r\n\r\n\t/*\r\n\t\tЗаготовки popout'ов\r\n\t */\r\n\tshowLoader() {\r\n\t\tthis.showPopout(<ScreenSpinner/>);\r\n\t}\r\n\thideLoader() {\r\n\t\tthis.showPopout(null);\r\n\t}\r\n\tshowDialog({ title, description, buttonText, action }) {\r\n\t\tthis.showPopout(\r\n\t\t\t<Alert\r\n\t\t\t\tactionsLayout=\"vertical\"\r\n\t\t\t\tactions={[\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: buttonText || \"Удалить\",\r\n\t\t\t\t\t\taction,\r\n\t\t\t\t\t\tstyle: \"destructive\"\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Отмена\",\r\n\t\t\t\t\t\tautoclose: true,\r\n\t\t\t\t\t\tstyle: \"cancel\"\r\n\t\t\t\t\t}\r\n\t\t\t\t]}\r\n\t\t\t\tonClose={() => this.showPopout(null)}\r\n\t\t\t>\r\n\t\t\t\t<h2>{title}</h2>\r\n\t\t\t\t<p>{description}</p>\r\n\t\t\t</Alert>\r\n\t\t);\r\n\t}\r\n\tshowAlert({ title, description }) {\r\n\t\tthis.showPopout(\r\n\t\t\t<Alert\r\n\t\t\t\tactions={[{\r\n\t\t\t\t\ttitle: 'Закрыть',\r\n\t\t\t\t\tautoclose: true,\r\n\t\t\t\t\tstyle: 'cancel'\r\n\t\t\t\t}]}\r\n\t\t\t\tonClose={() => this.showPopout(null)}\r\n\t\t\t>\r\n\t\t\t\t<h2>{title}</h2>\r\n\t\t\t\t<p>{description}</p>\r\n\t\t\t</Alert>\r\n\t\t);\r\n\t}\r\n\r\n\t/*\r\n\t\tФункция, которая показывает модальное окно\r\n\t\tparams:\r\n\t\t\t@newModal - название нового модального окна\r\n\t */\r\n\tshowModal(newModal, params={}) {\r\n\t\tconst { showModal } = this.props;\r\n\t\tconst { activePanel } = this.state;\r\n\r\n\t\tvkConnect.send(\"VKWebAppDisableSwipeBack\", {});\r\n\t\twindow.history.pushState({ panel: activePanel, modal: newModal }, activePanel);\r\n\r\n\t\tshowModal(newModal, params);\r\n\t}\r\n\r\n\t/*\r\n\t\tФункция, которая скрывает все модальные окна\r\n\t */\r\n\thideModal() {\r\n\t\tconst { hideModal } = this.props;\r\n\t\tconst { activePanel, homePanel } = this.state;\r\n\r\n\t\tif (activePanel !== homePanel) {\r\n\t\t\tvkConnect.send(\"VKWebAppEnableSwipeBack\", {});\r\n\t\t}\r\n\r\n\t\thideModal();\r\n\t}\r\n\r\n\theaderVisible(newValue) {\r\n\t\tthis.setState({ header: newValue });\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tconst { homePanel } = this.state;\r\n\r\n\t\tvkConnect.send(\"VKWebAppDisableSwipeBack\", {});\r\n\t\twindow.addEventListener(\"popstate\", this.popBack);\r\n\t\twindow.history.replaceState({ panel: homePanel }, homePanel);\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tconst { history } = this.state;\r\n\t\twindow.removeEventListener(\"popstate\", this.popBack);\r\n\t\tfor(let i = 0; i < history.length - 1; i++) {\r\n\t\t\twindow.history.back()\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { id, children, pageParams } = this.props;\r\n\t\tconst { activePanel, history, popout, params, header } = this.state;\r\n\t\tconst { navigatorObject } = this;\r\n\r\n\t\treturn (\r\n\t\t\t<View\r\n\t\t\t\tid={id}\r\n\t\t\t\tactivePanel={activePanel}\r\n\t\t\t\thistory={history}\r\n\t\t\t\tpopout={popout}\r\n\t\t\t\theader={header}\r\n\t\t\t\tonSwipeBack={window.history.back.bind(window.history)}\r\n\t\t\t>\r\n\t\t\t\t{React.Children.map(children, (Child) =>\r\n\t\t\t\t\tReact.cloneElement(Child, {\r\n\t\t\t\t\t\tid: Child.props.id,\r\n\t\t\t\t\t\tnavigator: {\r\n\t\t\t\t\t\t\t...navigatorObject,\r\n\t\t\t\t\t\t\tparams: Child.props.id === activePanel ? { ...params, pageParams } : {}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t)}\r\n\t\t\t</View>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nPage.propTypes = {\r\n\tid: PropTypes.string.isRequired,\r\n\tactivePanel: PropTypes.string.isRequired,\r\n\tchildren: PropTypes.any,\r\n\theader: PropTypes.bool\r\n};\r\n\r\nPropTypes.defaultProps = {\r\n\tchildren: []\r\n};\r\n\r\nexport default Page;"]},"metadata":{},"sourceType":"module"}